---
title: "Dealing with Dummy Variables"
output:
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, comment=NA, toc=TRUE)
library(tidyverse)
```

So far we've been working with ordinal or ratio predictor variables, but what if we want to use a nominal predictor variable?

For example consider the data below showing some employees salaries in thousands of dollars, gender, and years of experience.  What if we wanted to make a model using gender as a predictor variable?
```{r echo=FALSE}
data.frame(salary=c(85, 95, 100), gender=c('male', 'female', 'male'), years=c(8, 10, 11) )
```

We cannot use it as it appears. But what if we decided to code gender by letting a 1 represent female, and a 0 represent male?
```{r echo=FALSE}
data.frame(salary=c(85, 95, 100), gender=c(0, 1, 0), years=c(8, 10, 11) )
```

Now we can create a linear model using these variables.

## A Clock Example

Let's say an antique clock dealer has collected data on recent auctions of grandfather clocks. The variables are `Price`: final selling price, `Bidders`: the number of bidders, `Age`: the age of the clock, `Temp`: the outside temperature the day of the auction, and `Condition`: the condition of the clock.
```{r}
clocks <- read_csv("auctionExtra.csv");
head(clocks)
```

Note when `R` imports this data set that `Condition` is a column containing characters rather than numbers.  Let's see what is in that column.
```{r}
unique(clocks$Condition)
```

There are three options in that column. This means we will need two dummy variables to indicate all possible options. Do you recall above that we needed one variable to represent the two options male/female?  In general, when we have $n$ options we will need $n-1$ dummy variables.

```{r echo=FALSE}
clocks$Condition_Fair <- as.numeric(clocks$Condition == "Fair")
clocks$Condition_Good <- as.numeric(clocks$Condition == "Good")
head(clocks)
```

Notice the extra two columns?  There is a column to indicate "Fair", and a column to indicate "Good".  So if there is a 0 in both columns then that must mean the condition was "Excellent".

The process for generating a model in `R` is very straightforward.  Simply run the same `lm` command and `R` will detect the nominal predictor variable and create dummy variables for us automatically.

Let's try to a model to predict price using all the other variables present.
```{r}
attach(clocks)
summary(lm(Price ~ Age + Bidders + Temp + Condition))
```

Notice there are two variables for "Condition".  `R` created dummy variables in the same way we did.

Using bacwards elimination we would remove the `Temp` variable and have the resulting model.
```{r}
model <- lm(Price ~ Age + Bidders + Condition)
summary(model)
```

So the equation from this model is
$$Price = -401.09 + 8.94 * Age + 63.66 * Bidders - 295.63 * ConditionFair - 
    253.31 * ConditionGood$$

In effect this gives us three equations.  If the clock is in fair condition then we will plug in 1 for ConditionFair, and 0 for ConditionGood.  This gives the equation:
$$Price = -401.09 + 8.94 * Age + 63.66 * Bidders - 295.63 * 1$$
$$Price = -696.72 + 8.94 * Age + 63.66 * Bidders$$

Similarly, a clock that is in good condition will have a 1 for ConditionGood and 0 for ConditionFair giving
$$Price = -654.40 + 8.94 * Age + 63.66 * Bidders$$

And finally, a clock in excellent condition has a 0 for both dummy variables giving the equation
$$Price = -401.09 + 8.94 * Age + 63.66 * Bidders$$

Did you notice that the only thing really changing is the constant term?  The coefficents on the other variables stay the same. So the rate at which `Age` affects the price will be the same for clocks in any condition.


